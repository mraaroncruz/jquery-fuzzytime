(function(b){var a=function(m,p,f){var p=p||false,f=f||new Date().valueOf(),c,j,n=31556926,l=2629744,e=604800,o=86400,i=3600,h=60,q="a long time",d=[h,h*20,i,i*4,o,o*2,o*4,e,e*2,l,l*2,l*4,n,n*2,n*4,n*8,n*12,n*24,n*64],k=["moments","a few minutes","less than an hour","a couple of hours","less than a day","about a day","a couple of days","less than a week","about a week","less than a month","about a month","a couple of months","less than a year","about a year","a couple of years","a few years","about a decade","a couple of decades","several decades",],g=[{val:h,string:"minute"},{val:i,string:"hour"},{val:o,string:"day"},{val:e,string:"week"},{val:l,string:"month"},{val:n,string:"year"}];this.parse=function(){var u=new Date(m.replace(/(UTC)?\+/,"UTC+"));if(!u){u=this.iso8601(m)}if(!u){return"some time ago"}j=Math.abs((f-u)/1000);if(!p){for(var t=0;t<d.length;t++){if(j<d[t]){q=k[t];break}}}else{for(var t=0;t<g.length;t++){if(j<g[t]["val"]){if(t==0){q="less than a minute";break}else{var s=Math.floor(j/g[t-1]["val"]),r=s+" "+g[t-1]["string"];q=s>1?r+"s":r;break}}}}return j>0?q+" ago":"in "+q};this.iso8601=function(t){var r=b.trim(t);r=r.replace(/\.\d\d\d+/,"");r=r.replace(/-/,"/").replace(/-/,"/");r=r.replace(/T/," ").replace(/Z/," UTC");r=r.replace(/([\+-]\d\d)\:?(\d\d)/," $1$2");return new Date(r).valueOf()}};b.extend({fuzzytime:function(f,c,d){var e=new a(f,c,d);return e.parse()}})}(jQuery));